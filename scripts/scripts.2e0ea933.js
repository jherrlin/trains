"use strict";angular.module("projectsApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]),angular.module("projectsApp").controller("MainCtrl",["$scope","carDistance","carPrices","chart","trainPrices","route","stations",function(a,b,c,d,e,f,g){var h=new google.maps.Map(document.getElementById("map"),{center:{lat:56.8665586,lng:14.700005},zoom:9});a.updateCalculations=function(){a.carPrice=c.calculate(a.carDistance.value,a.carCostPerMil),d.draw(a.trainPrice,a.carPrice),a.$apply()},a.changeTrip=function(){var b,d;null!==a.start&&null!==a.destination&&(f.init(h),d=g[a.start],b=g[a.destination],f.updateTrainRoute(d,b,function(g){a.trainDistance=g.routes[0].legs[0].distance,a.trainPrice=e.total(d.id,b.id),f.updateCarRoute(d,b,function(b){a.carDistance=b.routes[0].legs[0].distance,a.carPrice=c.calculate(a.carDistance.value,a.carCostPerMil),a.updateCalculations()})}))},a.stations=g,a.start=0,a.destination=7,a.carCostPerMil=12.6,a.gasconsuming_total=0,a.changeTrip()}]),angular.module("projectsApp").service("stations",function(){return[{id:0,name:"Osby",lat:56.3799096,lng:13.9942982},{id:1,name:"Killeberg",lat:56.4747785,lng:14.0983654},{id:2,name:"Älmhult",lat:56.5514265,lng:14.1369853},{id:3,name:"Diö",lat:56.6341785,lng:14.2152617},{id:4,name:"Vislanda",lat:56.7869928,lng:14.4535807},{id:5,name:"Alvesta",lat:56.8987814,lng:14.5563187},{id:6,name:"Gemla",lat:56.8700707,lng:14.6448319},{id:7,name:"Växjö",lat:56.8762984,lng:14.8066909},{id:8,name:"Moheda",lat:57.0032787,lng:14.5768613},{id:9,name:"Lammhult",lat:57.171038,lng:14.5853829}]}),angular.module("projectsApp").service("carPrices",function(){var a=[[0,740.88,1194.48,1738.8,3049.2,3729.6,4052.16,4158,4399.92,5433.12],[740.88,0,544.32,1088.64,2404.08,3084.48,3402,3507.84,3754.8,4782.96],[1194.48,544.32,0,554.4,1985.76,2666.16,2983.68,3089.52,3336.48,4364.64],[1738.8,1088.64,554.4,0,1426.32,2106.72,2429.28,2535.12,2777.04,3810.24],[3049.2,2404.08,1985.76,1426.32,0,735.84,1134,1476.72,1406.16,2434.32],[3729.6,3084.48,2666.16,2106.72,735.84,0,393.12,992.88,680.4,1713.6],[4052.16,3402,2983.68,2429.28,1134,393.12,0,690.48,1063.44,2091.6],[4158,3507.84,3089.52,2535.12,1476.72,992.88,690.48,0,1260,1955.52],[4399.92,3754.8,3336.48,2777.04,1406.16,680.4,1063.44,1260,0,1199.52],[5433.12,4782.96,4364.64,3810.24,2434.32,1713.6,2091.6,1955.52,1199.52,0]],b={total:function(b,c){return a[b][c]},calculate:function(a,b){var c=a/1e4,d=c*b,e=40;return d*e}};return b}),angular.module("projectsApp").service("carDistance",function(){var a=[[0,14.7,23.7,34.5,60.5,74,80.4,82.5,87.3,107.8],[14.7,0,10.8,21.6,47.7,61.2,67.5,69.6,74.5,94.9],[23.7,10.8,0,11,39.4,52.9,59.2,61.3,66.2,86.6],[34.5,21.6,11,0,28.3,41.8,48.2,50.3,55.1,75.6],[60.5,47.7,39.4,28.3,0,14.6,22.5,29.3,27.9,48.3],[74,61.2,52.9,41.8,14.6,0,7.8,19.7,13.5,34],[80.4,67.5,59.2,48.2,22.5,7.8,0,13.7,21.1,41.5],[82.5,69.6,61.3,50.3,29.3,19.7,13.7,0,25,38.8],[87.3,74.5,66.2,55.1,27.9,13.5,21.1,25,0,23.8],[107.8,94.9,86.6,75.6,48.3,34,41.5,38.8,23.8,0]],b={total:function(b,c){return a[b][c]}};return b}),angular.module("projectsApp").service("trainPrices",function(){var a=[[0,399,694,854,1374,1454,1534,1614,1534,1614],[399,0,520,854,1374,1454,1534,1614,1534,1614],[694,520,0,840,1040,1120,1200,1280,1200,1280],[854,854,840,0,940,1040,1120,1200,1120,1200],[1374,1374,1040,940,0,840,940,1040,940,1040],[1454,1454,1120,1040,840,0,840,940,840,940],[1534,1534,1200,1120,940,840,0,840,940,1040],[1614,1614,1280,1200,1040,940,840,0,1040,1120],[1534,1534,1200,1120,940,840,940,1040,0,840],[1614,1614,1280,1200,1040,940,1040,1120,840,0]],b={total:function(b,c){return a[b][c]}};return b}),angular.module("projectsApp").service("route",function(){var a=new google.maps.DirectionsService,b=new google.maps.DirectionsRenderer,c=new google.maps.DirectionsRenderer({polylineOptions:{strokeColor:"red"}}),d={provideRouteAlternatives:!1,travelMode:google.maps.TravelMode.TRANSIT,transitOptions:{modes:[google.maps.TransitMode.RAIL],routingPreference:google.maps.TransitRoutePreference.FEWER_TRANSFERS}},e={provideRouteAlternatives:!1,travelMode:google.maps.TravelMode.DRIVING},f=function(a,b){return d.origin=new google.maps.LatLng(a.lat,a.lng),d.destination=new google.maps.LatLng(b.lat,b.lng),d.transitOptions.departureTime=new Date(1453043101312),d},g=function(a,b){return e.origin=new google.maps.LatLng(a.lat,a.lng),e.destination=new google.maps.LatLng(b.lat,b.lng),e};return{init:function(a){b.setMap(a),c.setMap(a)},updateTrainRoute:function(c,d,e){var g=f(c,d),h=function(a,c){c===google.maps.DirectionsStatus.OK&&(b.setDirections(a),e(a))};a.route(g,h)},updateCarRoute:function(b,d,e){var f=g(b,d),h=function(a,b){b===google.maps.DirectionsStatus.OK&&(c.setDirections(a),e(a))};a.route(f,h)}}}),angular.module("projectsApp").service("chart",function(){var a={},b={labels:["Månadskostnad"],datasets:[{label:"Tåg",fillColor:"lightblue",data:[0]},{label:"Bil",fillColor:"red",data:[0]}]},c=document.getElementById("chart").getContext("2d"),d=new Chart(c).Bar(b,a);return{draw:function(a,b){console.log(d.datasets),d.datasets[0].bars[0].value=a,d.datasets[1].bars[0].value=b,d.update()}}}),angular.module("projectsApp").run(["$templateCache",function(a){a.put("views/main.html",'<div class="settings col-sm-4"> <form> <div class="form-group"> <label for="exampleInputEmail1">Startpunkt</label> <select class="form-control" ng-model="start" ng-options="s.id as s.name for s in stations" ng-change="changeTrip()"> <option>{{ station.name }}</option> </select> </div> <div class="form-group"> <label for="exampleInputPassword1">Destination</label> <select class="form-control" ng-model="destination" ng-options="s.id as s.name for s in stations" ng-change="changeTrip()"> <option>{{ station.name }}</option> </select> </div> <div class="form-group"> <label>Bilkostnad per mil:</label> <input class="form-control" ng-model="carCostPerMil" ng-change="updateCalculations()">  </div> </form> <table class="table table-striped"> <thead> <th>Avstånd</th> <th>Pris</th> <th></th> </thead> <tbody> <tr> <td>{{ carDistance.text }}</td> <td>{{ carPrice.toFixed(0) }}kr</td> <th>Bil</th> </tr> <tr> <td>{{ trainDistance.text }}</td> <td>{{ trainPrice }} kr</td> <th>Tåg</th> </tr> </tbody> </table> <p>*Priserna beräknade på 40 resor per månad.</p> <canvas id="chart"></canvas> <ul> <li><span class="train-legend"></span> Tåg</li> <li><span class="car-legend"></span> Bil</li> </ul> <p class="creators">Sidan skapad av <a href="https://github.com/jherrlin">John Herrlin</a> &amp; <a href="https://github.com/rk222ev">Robin Karlsson</a>.</p> </div> <div id="map" class="col-sm-8"> </div>')}]);